! ============================================================================
! ============ Namelist file for REcoM Biogeochemical Model =================
! ============================================================================
! Regional Ecosystem Model (REcoM) configuration
! This file controls biogeochemical processes including:
! - Carbon, nitrogen, silicon, iron cycling
! - Phytoplankton (small phyto, diatoms, coccolithophores)
! - Zooplankton (micro, meso, krill)
! - Organic matter remineralization and sinking
! - Carbonate chemistry and air-sea CO2 fluxes
! - External nutrient inputs (dust, rivers, erosion)
! ============================================================================

! ============================================================================
! DATA SOURCES AND INPUT FILES
! ============================================================================
&nam_rsbc
fe_data_source        ='Albani'
nm_fe_data_file       ='/albedo/work/projects/p_pool_recom/input/mesh_CORE2_finaltopo_mean/DustClimMonthlyAlbani.nc'
nm_aen_data_file      ='/albedo/work/projects/p_pool_recom/input/mesh_CORE2_finaltopo_mean/AeolianNitrogenDep.nc'
nm_river_data_file    ='/albedo/work/projects/p_pool_recom/input/mesh_CORE2_finaltopo_mean/RiverineInput.nc'
nm_erosion_data_file  ='/albedo/work/projects/p_pool_recom/input/mesh_CORE2_finaltopo_mean/ErosionInput.nc'
nm_co2_data_file      ='/albedo/work/projects/p_pool_recom/input/mesh_CORE2_finaltopo_mean/MonthlyAtmCO2_gcb2024.nc'
/

! ============================================================================
! GENERAL MODEL CONFIGURATION
! ============================================================================
&parecomsetup
enable_3zoo2det = .true.    ! Enable 3 zooplankton + 2 detritus configuration
enable_coccos   = .true.   ! Enable coccolithophores
/

! ============================================================================
! MAIN MODEL SWITCHES AND SETTINGS
! ============================================================================
! --- Core Model Settings ---
&pavariables
use_REcoM             = .true.
REcoM_restart         = .true.
recom_debug           = .false.

! --- Tracer Configuration ---
bgc_num               = 36 !idoct !37           ! Total number of BGC tracers
diags3d_num           = 31           ! Number of diagnostic 3D tracers
bgc_base_num          = 22           ! Number of standard tracers
benthos_num           = 4            ! Number of benthic BGC tracers (8 if ciso=.true., else 4)
sedflx_num            = 0            ! Sediment fluxes from MEDUSA (0 = use defaults)
bottflx_num           = 4            ! Bottom fluxes (8 if ciso & ciso_14, 6 if not ciso_14, 4 otherwise)

! --- Sinking Velocities [m/day] ---
VDet                  = 20.d0        ! Small detritus sinking velocity (constant, positive down)
VDet_zoo2             = 200.d0       ! Large detritus sinking velocity
VPhy                  = 0.d0         ! Small phytoplankton (non-sinking)
VDia                  = 0.d0         ! Diatoms (variable sinking if allow_var_sinking=.true.)
VCocco                = 0.d0         ! Coccolithophores
VPhaeo                = 0.d0 
allow_var_sinking     = .true.       ! Enable variable sinking velocity

! --- Time Stepping ---
biostep               = 1            ! Number of biology sub-steps per physical time step

! --- Process Switches ---
REcoM_Geider_limiter              = .false.    ! Use Geider limiter for nutrient limitation
REcoM_Grazing_Variable_Preference = .true.     ! Variable grazing preference (PhyN vs DiaN)
Grazing_detritus                  = .true.     ! Enable zooplankton grazing on detritus
het_resp_noredfield               = .true.     ! Non-Redfield respiration for copepods
diatom_mucus                      = .true.     ! Nutrient-limited diatom aggregation
O2dep_remin                       = .true.     ! O2-dependent organic matter remineralization
use_ballasting                    = .true.     ! Ballast effect on sinking
use_density_scaling               = .true.     ! Density-dependent sinking
use_viscosity_scaling             = .true.     ! Viscosity-dependent sinking
OmegaC_diss                       = .true.    ! OmegaC-dependent calcite dissolution (set calc_diss_guts=0 if false)
CO2lim                            = .true.     ! CO2 effects on growth and calcification
use_photodamage                   = .true.     ! Chlorophyll photodamage (Alvarez et al. 2018)
HetRespFlux_plus                  = .true.     ! Stabilized zooplankton respiration computation
Diags                             = .true.     ! Enable diagnostics output

! --- External Inputs ---
constant_CO2          = .true.
UseFeDust             = .true.       ! Enable iron input from dust
UseDustClim           = .true.       ! Use dust climatology
UseDustClimAlbani     = .true.       ! Use Albani dust fields (false = Mahowald)
useRivers             = .true.       ! Enable riverine inputs
constant_PI_Rivers    = .true.
useRivFe              = .false.      ! Enable riverine iron source
useErosion            = .false.      ! Enable erosion inputs
NitrogenSS            = .false.      ! Enable nitrogen sources/sinks (rivers, aeolian, denitrification)
useAeolianN           = .false.      ! Enable aeolian nitrogen deposition

! --- Time Period Configuration ---
firstyearoffesomcycle = 1958         ! First year of physical forcing (e.g., JRA-55)
lastyearoffesomcycle  = 2024         ! Last year of physical forcing
numofCO2cycles        = 1            ! Number of forcing cycles
currentCO2cycle       = 1            ! Current forcing cycle number

! --- Alkalinity and Carbon ---
DIC_PI                = .true.       ! Use pre-industrial DIC
restore_alkalinity    = .true.       ! Restore surface alkalinity
Nmocsy                = 1            ! Vector length for mocsy (always 1 for REcoM)

! --- Data Path ---
REcoMDataPath         = '/albedo/work/projects/p_bio/input/mesh_CORE2_finaltopo_mean/'

! --- Carbon Isotopes ---
ciso                  = .false.      ! Enable carbon isotopes (13C, 14C)

! --- Sediment Model ---
use_MEDUSA            = .false.      ! Enable MEDUSA sediment model

! --- Miscellaneous ---
use_atbox             = .false.      ! Use atmospheric box model
add_loopback          = .false.      ! Add loopback fluxes through rivers
lb_tscale             = 1.0          ! Loopback timescale [1/year]
/

! ============================================================================
! SINKING VELOCITY PARAMETERS
! ============================================================================
&pasinking
Vdet_a                = 0.0288       ! Small detritus remineralization rate [1/day]
Vcalc                 = 0.0144       ! Calcite remineralization rate [1/day]
/

! ============================================================================
! INITIAL CONDITIONS
! ============================================================================
&painitialization_N
cPhyN                 = 0.2d0        ! Initial small phytoplankton nitrogen [mmol N/m³]
cHetN                 = 0.2d0        ! Initial microzooplankton nitrogen [mmol N/m³]
cZoo2N                = 0.2d0        ! Initial mesozooplankton nitrogen [mmol N/m³]
/

! ============================================================================
! TEMPERATURE DEPENDENCE (ARRHENIUS)
! ============================================================================
&paArrhenius
recom_Tref            = 288.15d0     ! Reference temperature [K]
C2K                   = 273.15d0     ! Celsius to Kelvin conversion
Ae                    = 4500.d0      ! Arrhenius slope [K]
Tmax_phaeo            = 16d0         ! [°C] For Blanchard temp fxn: maximum temperature
Topt_phaeo            = 6.7982d0     ! [°C] For Blanchard temp fxn: optimum temperature
uopt_phaeo            = 0.6903d0     ! [1/day] For Blanchard temp fxn: optimum growth rate
beta_phaeo            = 0.7114d0     ! [unitless] For Blanchard temp fxn
ord_d                 = -0.2216d0    ! diatom ordonnée
expon_d               = 0.0406d0     ! diatom exponent
ord_phy               = -0.7338d0    ! small phyto ordonnée
expon_phy             = 0.06422d0    ! small phyto exponent
ord_cocco             = -0.2310d0    ! coccolitho ordonnée
expon_cocco           = 0.0327d0     ! coccolitho exponent
ord_phaeo             = -0.2310d0    ! phaeocystis ordonnée
expon_phaeo           = 0.0327d0     ! phaeocystis exponent
reminSi               = 0.02d0       ! Silicate remineralization base rate [1/day]
k_o2_remin            = 15.d0        ! Half-saturation for O2 remineralization [mmol O2/m³]
/

&palimiter_function
! --- Limitation Function Slopes ---
NMinSlope             = 50.d0        ! Nitrogen minimum slope
SiMinSlope            = 1000.d0      ! Silicon minimum slope

! --- Minimum Quotas [mmol/mmol C] ---
NCmin                 = 0.04d0       ! Small phytoplankton N:C minimum
NCmin_d               = 0.04d0       ! Diatom N:C minimum
NCmin_c               = 0.04d0       ! Coccolithophore N:C minimum
NCmin_p               = 0.04d0       ! Phaeocystis N:C minimum
SiCmin                = 0.04d0       ! Diatom Si:C minimum

! --- Half-Saturation Constants ---
k_Fe                  = 0.04d0       ! Small phyto iron half-sat [µmol Fe/m³]
k_Fe_d                = 0.12d0       ! Diatom iron half-sat [µmol Fe/m³]
k_Fe_c                = 0.09d0       ! Coccolith iron half-sat [µmol Fe/m³]
k_Fe_p                = 0.09d0      ! NEW for Phaeocystis (to be tuned)
k_si                  = 4.d0         ! Silicon half-sat [mmol Si/m³]

! --- Maximum Photosynthesis Rates [1/day] ---
P_cm                  = 3.0d0        ! Small phytoplankton max C-specific photosynthesis
P_cm_d                = 3.5d0        ! Diatom max C-specific photosynthesis
P_cm_c                = 2.8d0        ! Coccolithophore max C-specific photosynthesis
P_cm_p                = 0.75d0       ! NEW for Phaeocystis (to be tuned)
/

! ============================================================================
! LIGHT ATTENUATION
! ============================================================================
&palight_calculations
k_w                   = 0.04d0       ! Water attenuation coefficient [1/m]
a_chl                 = 0.03d0       ! Chlorophyll-specific attenuation [1/m per mg Chl/m³]
/

! ============================================================================
! PHOTOSYNTHESIS (P-I CURVE)
! ============================================================================
&paphotosynthesis
alfa                  = 0.14d0       ! Small phyto initial P-I slope [(mmol C·m²)/(mg Chl·W·day)]
alfa_d                = 0.19d0       ! Diatom initial P-I slope
alfa_c                = 0.10d0       ! Coccolithophore initial P-I slope
alfa_p                = 0.17d0       ! Phaeocystis initial P-I slope (to be tuned)
parFrac               = 0.43d0       ! Fraction of shortwave that is PAR
/

! ============================================================================
! NUTRIENT ASSIMILATION
! ============================================================================
&paassimilation
! --- Maximum Uptake Scaling ---
V_cm_fact             = 0.7d0        ! Small phyto N-uptake scaling factor
V_cm_fact_d           = 0.7d0        ! Diatom N-uptake scaling factor
V_cm_fact_c           = 0.7d0        ! Coccolithophore N-uptake scaling factor
V_cm_fact_p           = 0.7d0       ! NEW for Phaeocystis

! --- Limitation Function Slopes ---
NMaxSlope             = 1000.d0      ! Nitrogen maximum slope
SiMaxSlope            = 1000.d0      ! Silicon maximum slope

! --- Maximum Cell Quotas [mmol/mmol C] ---
NCmax                 = 0.2d0        ! Small phyto maximum N:C
NCmax_d               = 0.2d0        ! Diatom maximum N:C
NCmax_c               = 0.15d0       ! Coccolithophore maximum N:C
NCmax_p               = 0.15d0       ! Phaeocystis maximum N:C (to be tuned)
SiCmax                = 0.8d0        ! Diatom maximum Si:C

! --- Maximum Uptake Ratios [mmol/mmol C] ---
NCuptakeRatio         = 0.2d0        ! Small phyto N:C uptake ratio
NCUptakeRatio_d       = 0.2d0        ! Diatom N:C uptake ratio
NCUptakeRatio_c       = 0.2d0        ! Coccolithophore N:C uptake ratio
NCUptakeRatio_p       = 0.2d0       ! NEW for Phaeocystis
SiCUptakeRatio        = 0.2d0        ! Diatom Si:C uptake ratio

! --- Chlorophyll Parameters ---
Chl2N_max             = 3.15d0       ! Small phyto max Chl:N [mg Chl/mmol N]
Chl2N_max_d           = 4.2d0        ! Diatom max Chl:N [mg Chl/mmol N]
Chl2N_max_c           = 3.5d0        ! Coccolithophore max Chl:N [mg Chl/mmol N]
Chl2N_max_p           = 2.6d0       ! NEW for Phaeocystis

! --- Half-Saturation Constants ---
k_din                 = 0.55d0       ! Small phyto nitrate half-sat [mmol N/m³]
k_din_d               = 1.0d0        ! Diatom nitrate half-sat [mmol N/m³]
k_din_c               = 0.9d0        ! Coccolith nitrate half-sat [mmol N/m³]
k_din_p               = 0.7d0      ! NEW for Phaeocystis (to be tuned)

! --- Respiration and Biosynthesis ---
res_phy               = 0.01d0       ! Small phyto maintenance respiration [1/day]
res_phy_d             = 0.01d0       ! Diatom maintenance respiration [1/day]
res_phy_c             = 0.01d0       ! Coccolithophore maintenance respiration [1/day]
res_phy_p             = 0.01d0      ! NEW for phaeocystis
biosynth              = 2.33d0       ! Cost of biosynthesis [mmol C/mmol N]
biosynthSi            = 0.d0         ! Silicon biosynthesis cost [mmol C/mmol Si]
/

! ============================================================================
! IRON CHEMISTRY
! ============================================================================
&pairon_chem
totalligand           = 1.d0         ! Total free ligand concentration [µmol/m³]
ligandStabConst       = 100.d0       ! Ligand-Fe stability constant [m³/µmol]
/

! ============================================================================
! MICROZOOPLANKTON (FIRST ZOOPLANKTON)
! ============================================================================
&pazooplankton
graz_max              = 0.31d0       ! Maximum grazing rate [1/day]
epsilonr              = 0.09d0       ! Half-saturation constant [(mmol N)²/m⁶]
res_het               = 0.028d0      ! Respiration + mortality [1/day]
Redfield              = 6.625        ! C:N Redfield ratio [mmol C/mmol N]
loss_het              = 0.04d0       ! Extracellular N degradation [1/day]
tiny_het              = 1.d-5        ! Small number for stable computation

! --- Grazing Preferences ---
pzDia                 = 1.0d0        ! Diatom preference (maximum) NEW value for Phaeocystis
sDiaNsq               = 0.d0         ! Diatom preference slope
pzPhy                 = 0.5d0        ! Small phyto preference NEW value for Phaeocystis
sPhyNsq               = 0.d0         ! Small phyto preference slope
pzCocco               = 0.666d0      ! Coccolithophore preference NEW value for Phaeocystis
sCoccoNsq             = 0.d0         ! Coccolithophore preference slope
pzPhaeo               = 0.5d0        ! Phaeocystis preference
sPhaeoNsq             = 0.d0         ! Phaeocystis preference slope
pzMicZoo              = 1.0d0        ! Microzooplankton preference (self-grazing)
sMicZooNsq            = 0.d0         ! Microzooplankton preference slope
/

! ============================================================================
! MESOZOOPLANKTON (SECOND ZOOPLANKTON)
! ============================================================================
&pasecondzooplankton
graz_max2             = 0.25d0       ! Maximum grazing rate [1/day] NEW value for Phaeocystis                                                                                     
epsilon2              = 0.0144d0     ! Half-saturation constant [(mmol N)²/m⁶]
res_zoo2              = 0.0107d0     ! Respiration + mortality [1/day]
loss_zoo2             = 0.003d0      ! Extracellular N degradation [1/day]

! --- Fecal Pellet Production ---
fecal_rate_n          = 0.104d0      ! Nitrogen fecal rate [1/day]
fecal_rate_c          = 0.236d0      ! Carbon fecal rate [1/day]
fecal_rate_n_mes      = 0.25d0       ! Mesozooplankton N fecal rate [1/day]
fecal_rate_c_mes      = 0.32d0       ! Mesozooplankton C fecal rate [1/day]

! --- Grazing Preferences ---
pzDia2                = 1.5d0 !1.0d0 ! Diatom preference NEW value for Phaeocystis
sDiaNsq2              = 0.d0         ! Diatom preference slope
pzPhy2                = 0.5d0 !0.07d0! Small phyto preference NEW value for Phaeocystis
sPhyNsq2              = 0.d0         ! Small phyto preference slope
pzCocco2              = 0.5d0 !0.7d0 ! Coccolithophore preference NEW value for Phaeocystis
sCoccoNsq2            = 0.d0         ! Coccolithophore preference slope
pzPhaeo2              = 0.5d0        ! Phaeocystis preference
sPhaeoNsq2            = 0.d0         ! Phaeocystis preference slope
pzHet                 = 1.5d0        ! Microzooplankton preference
sHetNsq               = 0.d0         ! Microzooplankton preference slope
pzMicZoo2             = 1.0d0        ! Mesozooplankton preference
sMicZooNsq2           = 0.d0         ! Mesozooplankton preference slope

! --- Temperature Function (Krill-specific) ---
t1_zoo2               = 28145.d0     ! Temperature function constant 1
t2_zoo2               = 272.5d0      ! Temperature function constant 2 [K]
t3_zoo2               = 105234.d0    ! Temperature function constant 3
t4_zoo2               = 274.15d0     ! Temperature function constant 4 [K]
/

! ============================================================================
! MICROZOOPLANKTON (THIRD ZOOPLANKTON)
! ============================================================================
&pathirdzooplankton
graz_max3             = 0.36d0       ! Maximum grazing rate [1/day] NEW value for Phaeocystis
epsilon3              = 0.64d0       ! Half-saturation constant [(mmol N)²/m⁶]
loss_miczoo           = 0.01d0       ! Extracellular N degradation [1/day]
res_miczoo            = 0.01d0       ! Respiration + mortality [1/day] NEW value for Phaeocystis

! --- Grazing Preferences ---
pzDia3                = 0.5d0 !0.04d0! Maximum diatom preference NEW value for Phaeocystis
sDiaNsq3              = 0.d0         ! Diatom preference slope
pzPhy3                = 1.0d0 !0.07d0! Small phyto preference NEW value for Phaeocystis
sPhyNsq3              = 0.d0         ! Small phyto preference slope
pzCocco3              = 0.5d0 !0.7d0 ! Coccolithophore preference ATTENTION: This value needs to be tuned; I start with zero preference! ! NEW value for Phaeocystis
sCoccoNsq3            = 0.d0         ! Coccolithophore preference slope
pzPhaeo3              = 0.25d0       ! Phaeocystis preference
sPhaeoNsq3            = 0.d0         ! Phaeocystis preference slope
/

! ============================================================================
! GRAZING ON DETRITUS
! ============================================================================
&pagrazingdetritus
! --- First Zooplankton (Microzooplankton) ---
pzDet                 = 0.5d0        ! Small detritus preference
sDetNsq               = 0.d0         ! Small detritus preference slope
pzDetZ2               = 0.5d0        ! Large detritus preference
sDetZ2Nsq             = 0.d0         ! Large detritus preference slope

! --- Second Zooplankton (Mesozooplankton) ---
pzDet2                = 0.5d0        ! Small detritus preference
sDetNsq2              = 0.d0         ! Small detritus preference slope
pzDetZ22              = 0.5d0        ! Large detritus preference
sDetZ2Nsq2            = 0.d0         ! Large detritus preference slope
/

! ============================================================================
! AGGREGATION
! ============================================================================
&paaggregation
agg_PD                = 0.165d0      ! Detritus aggregation rate [m³/(mmol N·day)]
agg_PP                = 0.015d0      ! Plankton aggregation rate [m³/(mmol N·day)]
/

! ============================================================================
! DISSOLVED ORGANIC MATTER REMINERALIZATION
! ============================================================================
&padin_rho_N
rho_N                 = 0.11d0       ! DON remineralization rate [1/day]
rho_Nt                = 0.67d0       ! [1/day] terrestrial N degradation of extracellular organic N (DONt) (Remineralization of terrestrial DON) ~ scale of 1.5 years ! R2OMIP
/

&padic_rho_C1
rho_C1                = 0.1d0        ! DOC remineralization rate [1/day]
rho_C1t               = 0.0018d0     !terrestrial C degradation of extracellular organic C (EOC) ! R2OMIP
/

! ============================================================================
! PHYTOPLANKTON LOSSES
! ============================================================================
&paphytoplankton_N
lossN                 = 0.05d0       ! Small phyto N loss rate [1/day]
lossN_d               = 0.05d0       ! Diatom N loss rate [1/day]
lossN_c               = 0.05d0       ! Coccolithophore N loss rate [1/day]
lossN_p               = 0.05d0      ! NEW for Phaeocystis
/

&paphytoplankton_C
lossC                 = 0.10d0       ! Small phyto C loss rate [1/day]
lossC_d               = 0.10d0       ! Diatom C loss rate [1/day]
lossC_c               = 0.10d0       ! Coccolithophore C loss rate [1/day]
lossC_p               = 0.10d0      ! NEW for Phaeocystis
/

&paphytoplankton_ChlA
deg_Chl               = 0.15d0 !0.25d0 !0.2d0       ! Small phyto Chl degradation [1/day]
deg_Chl_d             = 0.2d0 ! 0.15d0              ! Diatom Chl degradation [1/day]
deg_Chl_c             = 0.2d0                       ! Coccolithophore Chl degradation [1/day]
deg_Chl_p             = 0.15d0       ! NEW for Phaeocystis
/

! ============================================================================
! DETRITUS REMINERALIZATION
! ============================================================================
&padetritus_N
gfin                  = 0.3d0        ! First zooplankton grazing efficiency
grazEff2              = 0.8d0        ! Second zooplankton grazing efficiency
grazEff3              = 0.8d0        ! Third zooplankton grazing efficiency
reminN                = 0.165d0      ! Detritus N remineralization rate [1/day]
/

&padetritus_C
reminC                = 0.15d0       ! Detritus C remineralization rate [1/day]
rho_c2                = 0.1d0        ! TEP-C degradation rate [1/day]
/

! ============================================================================
! ZOOPLANKTON LOSSES
! ============================================================================
&paheterotrophs
lossN_z               = 0.1d0        ! First zooplankton N loss [1/day]
lossC_z               = 0.1d0        ! First zooplankton C loss [1/day]
/

&paseczooloss
lossN_z2              = 0.02d0       ! Second zooplankton N loss [1/day]
lossC_z2              = 0.02d0       ! Second zooplankton C loss [1/day]
/

&pathirdzooloss
lossN_z3              = 0.05d0       ! Third zooplankton N loss [1/day]
lossC_z3              = 0.05d0       ! Third zooplankton C loss [1/day]
/

! ============================================================================
! CO2 LIMITATION PARAMETERS
! ============================================================================
&paco2lim                 
Cunits                = 976.5625     ! Unit conversion factor: mol/m³ → µmol/kg

! --- Small Phytoplankton ---
a_co2_phy             = 1.162e+00    ! Dimensionless
b_co2_phy             = 4.888e+01    ! [mol/kg]
c_co2_phy             = 2.255e-01    ! [kg/mol]
d_co2_phy             = 1.023e+07    ! [kg/mol]

! --- Diatoms ---
a_co2_dia             = 1.040e+00    ! Dimensionless
b_co2_dia             = 2.890e+01    ! [mol/kg]
c_co2_dia             = 8.778e-01    ! [kg/mol]
d_co2_dia             = 2.640e+06    ! [kg/mol]

! --- Coccolithophores ---
a_co2_cocco           = 1.109e+00    ! Dimensionless (growth)
b_co2_cocco           = 3.767e+01    ! [mol/kg] (growth)
c_co2_cocco           = 3.912e-01    ! [kg/mol] (growth)
d_co2_cocco           = 9.450e+06    ! [kg/mol] (growth)

! --- Phaeocystis ---
a_co2_phaeo           = 1.162e+00   ! Dimensionless
b_co2_phaeo           = 4.888e+01   ! [mol/kg]
c_co2_phaeo           = 2.255e-01   ! [kg/mol]
d_co2_phaeo           = 1.023e+07   ! [kg/mol]

a_co2_calc            = 1.102e+00    ! Dimensionless (calcification)
b_co2_calc            = 4.238e+01    ! [mol/kg] (calcification)
c_co2_calc            = 7.079e-01    ! [kg/mol] (calcification)
d_co2_calc            = 1.343e+07    ! [kg/mol] (calcification)
/

&pairon
Fe2N                  = 0.033d0      ! Iron to nitrogen ratio (= Fe2C × 6.625)
Fe2N_benthos          = 0.15d0       ! Benthic iron flux [µmol/m²/day]
kScavFe               = 0.07d0       ! Iron scavenging rate [1/day]
dust_sol              = 0.02d0       ! Dust iron solubility fraction
RiverFeConc           = 100          ! Riverine iron concentration [µmol/m³]
/

! ============================================================================
! CALCITE PRODUCTION AND DISSOLUTION
! ============================================================================
&pacalc
calc_prod_ratio       = 0.02         ! Calcite production ratio (CaCO₃:POC)
calc_diss_guts        = 0.5d0        ! Gut dissolution fraction (set to 0 if OmegaC_diss=.false.)
calc_diss_rate        = 0.005714d0   ! Standard dissolution rate [1/day] = 20/3500
calc_diss_rate2       = 0.005714d0   ! Standard dissolution rate [1/day]
calc_diss_omegac      = 0.197d0      ! Critical Ω_calcite (Aumont et al. 2015)
calc_diss_exp         = 1.d0         ! Dissolution rate exponent
/

! ============================================================================
! BENTHIC PROCESSES
! ============================================================================
&pabenthos_decay_rate
decayRateBenN         = 0.005d0      ! Benthic N decay rate [1/day]
decayRateBenC         = 0.005d0      ! Benthic C decay rate [1/day]
decayRateBenSi        = 0.005d0      ! Benthic Si decay rate [1/day]
q_NC_Denit            = 0.86d0       ! N:C quota for denitrification
/

! ============================================================================
! AIR-SEA CO2 FLUX
! ============================================================================
&paco2_flux_param
permil                = 0.000000976  ! DIC conversion: mmol/m³ → mol/kg (1e-3/1024.5)
permeg                = 1.e-6        ! Pressure conversion: µatm → atm
!X1                    = exp(-5.d0*log(10.d0))       ! Lowest ph-value = 7.7 (phlo)
!X2                    = exp(-9.d0*log(10.d0))       ! Highest ph-value = 9.5 (phhi)
Xacc                  = 1.e-12       ! pH iteration accuracy
CO2_for_spinup        = 278.d0       ! Pre-industrial atmospheric pCO₂ [µatm]
/

! ============================================================================
! ALKALINITY RESTORING
! ============================================================================
&paalkalinity_restoring
surf_relax_Alk        = 3.2e-07      ! Surface alkalinity relaxation [1/s] = 10 days⁻¹
/

! ============================================================================
! BALLASTING AND DENSITY-DEPENDENT SINKING
! ============================================================================
&paballasting
! --- Particle Densities [kg/m³] ---
rho_POC               = 1033.d0      ! POC density
rho_PON               = 1033.d0      ! PON density
rho_CaCO3             = 2830.d0      ! Calcite density
rho_opal              = 2090.d0      ! Biogenic opal density
rho_ref_part          = 1230.d0      ! Reference particle density
rho_ref_water         = 1027.d0      ! Reference seawater density

! --- Viscosity and Sinking ---
visc_ref_water        = 0.00158d0    ! Reference seawater viscosity [kg·m⁻¹·s⁻¹] at 4°C
w_ref1                = 10.d0        ! Reference sinking velocity, small detritus [m/day]
w_ref2                = 200.d0       ! Reference sinking velocity, large detritus [m/day]
depth_scaling1        = 0.01d0       ! Depth-dependent increase sinking speed of det1 [1/day]
depth_scaling2        = 0.d0         ! Depth-dependent increase sinking speed of det2 [1/day]
max_sinking_velocity  = 250.d0       ! Maximum sinking velocity [m/day] (numerical stability)
/

! ============================================================================
! CARBON ISOTOPES (¹³C AND ¹⁴C)
! ============================================================================
&paciso
ciso_init             = .false.      ! Initialize with fractionated organic matter
ciso_14               = .false.      ! Include inorganic radiocarbon (¹⁴C-DIC)
ciso_organic_14       = .false.      ! Include organic radiocarbon (¹⁴C-POC/DOC)
lambda_14             = 3.8561e-12   ! ¹⁴C decay constant [s⁻¹] (5730 yr half-life)
delta_CO2_13          = -6.61        ! Atmospheric δ¹³C [‰] (global mean)

! --- Atmospheric Δ¹⁴C
big_delta_CO2_14(1)  = 0. ! atmospheric D14C (permil), northern hemisphere polewards of 30°N
big_delta_CO2_14(2)  = 0. ! atmospheric D14C (permil), (sub) tropical zone 30°N - 30°S
big_delta_CO2_14(3)  = 0. ! atmospheric D14C (permil), southern hemisphere polewards of 30°S
atbox_spinup         = .false.
cosmic_14_init       = 2.0
/
